Chapter 3 from master.
